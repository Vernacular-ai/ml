{"componentChunkName":"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx","path":"/bad-audio-detection","result":{"data":{"post":{"__typename":"MdxPost","slug":"/bad-audio-detection","title":"Bad Audio Detection","date":"29.07.2020","tags":[{"name":"Audio Classification","slug":"audio-classification"}],"description":null,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Bad Audio Detection\",\n  \"date\": \"2020-07-29T00:00:00.000Z\",\n  \"tags\": [\"Audio Classification\"],\n  \"author\": \"anirudhdagar\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"This blog will be a short one, where we'll talk about our approach on filtering out inscrutable audios from \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://vernacular.ai/vasr\"\n  }), mdx(\"strong\", {\n    parentName: \"a\"\n  }, \"VASR\")), \".\"), mdx(\"p\", null, \"There are situations in Call Center Automation (CCA) pipeline where user utterances are bad. \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Bad\"), \" here is defined by things like noise, static, silences or background murmur etc. rendering the downstream SLU systems helpless. We started with a proposal and prepare a dataset for making an ML system learn to reject these audios.\"), mdx(\"h3\", null, \"Benefits\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"No more misfires from SLU side which ultimately leads to a better user experience.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Save compute and time by skipping bad audios.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"The whole system can be used for all our audio based tasks to predict and filter out the poor ones, hence avoiding sample noise for these tasks.\")), mdx(\"h3\", null, \"Dataset\"), mdx(\"p\", null, \"We prepared a dataset of intent tagged conversations with specially marked intents which tell us that these utterances are bad and them going further in SLU will result in errors. Also we have a sampling of non-bad utterances (tagged with regular intents) to make this a classification problem.\"), mdx(\"p\", null, \"There are total 9928 samples of audios labelled as bad and 20000 samples labeled as good.\"), mdx(\"p\", null, \"All the raw labels were not very useful, hence we clean and preprocess the data to finally create 2 broad categories with sub-classes.\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"audio-bad\")), mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"audio-noisy\"), \": Noisy audio.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"audio-silent\"), \": Silent audio.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"audio-talking\"), \": Background talking.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"hold-phone\"), \": Music from keeping on hold.\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"audio-good\")))), mdx(\"h3\", null, \"Exploratory Data Analysis\"), mdx(\"p\", null, \"We needed to understand the class imbalance and hence we plot a histogram representing number of samples for each class.\"), mdx(\"figure\", null, \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"figure\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"960px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"66.66666666666666%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA9hAAAPYQGoP6dpAAACDklEQVQ4y42Tz2sTQRTHV9D26t2jF/Wsf0jrL9CbWiyCeuml7UGk/gBvSmsVpR5qQKsgpqF6CPUH7VZRT5qapFrQrBWXtknc37sz+3XeS7Js2gQceOzM7JvPfN+P0eI4Bo0oimC7Pixlnh+odYgwDGGaJgzDQKVSYbNtm33pX9qklMzRWjDHcXDu4UfsHc5hYr7MP8NIYOsgAXS4ZbQWQjA0AYomsP/2IrTTj3Elt9xQLWM+kLZOg8AkioFEty0Lvu/j+B0dPYNPcH3ua0OhkE3IdnD6AgImCj0FMowKbxydXMTOswRcTsJLfzuFvw0YNBMfBEECvNYE1t2QVXaDdgT6rNDgkAnYo4BjuYIq0CfsGcpiamG1LXwhGyZTF7QDlTJSSEk9QkCVw7HZgprr0E49ws18uatCgsZbgeQXqYXrujimitI7+FRVuYAT95awS6kdn19hx3XLhxNEeFsy8eLzGn5V3VTosr1tpBTwPA99E6ptzszgUvYLDpNC1UI3XhZZ7e4LzzD5+hsOXc1jx8AMMu9+MGDTUXmOUm3TKj8pPD/9HvtHshjPF3Ex8wH7hp/j/psVDDxYwoHRWUzrqzh5dwEHL88ho39n/75br6CXfnNrUQq0dE+5no+Nak3dGPF8s1bnZ/hTPbliqYxqrcb79b8W7/9Zr2LN3IDtuEmeNfzH4CfGT0109WkV7R+rXrPRhrvTTAAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Can't See? Something went wrong!\",\n    \"title\": \"Can't See? Something went wrong!\",\n    \"src\": \"/ml/static/4c9d8fd5fbd1edecb4f5774a630bdafa/7d769/Class_Distribution.png\",\n    \"srcSet\": [\"/ml/static/4c9d8fd5fbd1edecb4f5774a630bdafa/5243c/Class_Distribution.png 240w\", \"/ml/static/4c9d8fd5fbd1edecb4f5774a630bdafa/ab158/Class_Distribution.png 480w\", \"/ml/static/4c9d8fd5fbd1edecb4f5774a630bdafa/7d769/Class_Distribution.png 960w\", \"/ml/static/4c9d8fd5fbd1edecb4f5774a630bdafa/5ece7/Class_Distribution.png 1200w\"],\n    \"sizes\": \"(max-width: 960px) 100vw, 960px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n    \")), mdx(\"figure\", null, \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"figure\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"960px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"66.66666666666666%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA9hAAAPYQGoP6dpAAABxUlEQVQ4y32Tz07CQBDGeR/fwLfwRTz5DMZgvGiURJ7FmydvniBCAgJtTUpLS4GWtruf800tUEQ3md1mOvObPzvbgqw8z7Fer1GWJRaLBcbjMVzXFfEwm80wnbrwPFfOqeo9z0MYhvpdFIX6G2OIQstaC8p2u1Xg8XIcoNtd67eYqS2DEpgkCeI4Vj9CFciNCmZYO8kuBlZ0BUYjg5ublegMGI+BB4MB+v0+JpOJVsAgOyBhm81GU2faFRBSjsHT00rP29s9kHbz+VwlCAKF0W8HzLJMe8PIh0DHsbi/r4DtdgVkm2jf6/UwHA4l+5H6NIAEMRIzPQY+PBwCLeoWV3a2cTYydKTzpzI8Bkq1CjhevzL0ff/PDB1nD6RPPRW1/AJyY6N5MTQoSxoafH1ZvZQgsLseErqH/APkjyzbqiKKgE4nkaaXuL5e4fU1xd0dh77Ay0vlFMemUXJjbOooaZrKKCR4f09weRng4mKO83MfZ2chrq5CvL0FeHxcyg1HeH5eCCCRwU619xRW+QPcNzZNcx3mKKIYLJe5PEMPHx8zfH56Ol6+H4odbTOBlCJ544W12JdKTi9jCimJQ185n7rlw9K/AXuL3rElE+jjAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Can't See? Something went wrong!\",\n    \"title\": \"Can't See? Something went wrong!\",\n    \"src\": \"/ml/static/2f8f7d0a4f9b03b7fb35684a894573af/7d769/EDA.png\",\n    \"srcSet\": [\"/ml/static/2f8f7d0a4f9b03b7fb35684a894573af/5243c/EDA.png 240w\", \"/ml/static/2f8f7d0a4f9b03b7fb35684a894573af/ab158/EDA.png 480w\", \"/ml/static/2f8f7d0a4f9b03b7fb35684a894573af/7d769/EDA.png 960w\", \"/ml/static/2f8f7d0a4f9b03b7fb35684a894573af/5ece7/EDA.png 1200w\"],\n    \"sizes\": \"(max-width: 960px) 100vw, 960px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n    \")), mdx(\"p\", null, \"We also plot the frequency vs duration histogram plot to understand the general distribution of audio durations in the dataset.\\nBased on the mean duration of 5.26 seconds and the peaks in the histogram, we decided to threshold our audios to 6.5 seconds.\\nAnything less than that will be padded to 6.5 seconds and anything greater than that duration will be truncated to 6.5 seconds.\"), mdx(\"p\", null, \"Even though we have sub-classes for \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"audio-bad\"), \" spanning different areas of what \\\"bad\\\" could be, we decided to focus only on the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"noisy audios\"), \". Silent Audios can be treated separately, since they do not actually require something as complex as an ML model to classify them. We can simply use the age-old powerful signal processing methods to filter those out with some good confidence.\"), mdx(\"h3\", null, \"Model\"), mdx(\"p\", null, \"If we are going to reject these bad audios then we need to do so with:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"High Precision\"), \": We should not be rejecting good audios which are perfectly interpretable and understandable. \"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Low Latency:\"), \" This system should have little to no latency, otherwise it will just slow down our whole VASR flow after being deployed and integrated.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Online:\"), \" The model should be capable of running in an online setting where continuous chunks of audios are fed into the system.\")), mdx(\"p\", null, \"We used a standard audio classification pipeline to train our binary classification task.\"), mdx(\"p\", null, \"This involves generating log-mel spectrograms and then running a Convolution Neural Network (CNN) based feature extractor on top of this fixed size spectrogram image.\"), mdx(\"figure\", null, \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"figure\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"960px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"40%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAAB8UlEQVQoz2NgZGBgYmBg4AFiQSBm4YbwGZQl5Rn0/DoYGaDAIKif0Sx6NliOkYlVjFdMjc8yaZWOReIKZpCYiJI1TGkMM6danZCEf40DT8L2KIbk81IMSMAobCqLRfxSbhDbNn1ziGXiqmAQ2zh8Oqdt5jYP69T1PAwooPrqcY6iC6/Vmk/+Fuq48Z+h6aGDe86uHof8A0dsM7eL22ftUHTI2fPeLmunk4nDJAb77F1T7LN364K02qRvdrDP2qljl7ldR9E8HmQwOwPDtIv/2Kac/a/Ze/S/5Jxj/xnmH3d2zdpz0q/x/n+7tE3+II1AQ7c5Zu/cDWIbhkxWs03f0u6UvYvdJn2TsG3GVjm7zG1q8saRHEBpVgaGtef+s6w6/9+yZf1/hdkbfjIs3uzs4j3TwjpiepNl2DRlkCGiStZSup51BjLGUZwgvrCChZK0XoAo0IWWpnHLmFG9vHRvD+uiXbkG+e0hRk0N2gwe8fxIskysHPxCQJoLFBdAzMfKwccHpLk5BWTYLROWKdqmrOFzyNjIKapsywhVgwqAIqIcwgq8////Z+AWlGMDCokJyZnCXAEynBdJORvQAj0hWUMOhPa+pSwsLbNY3VdfYzJevoGRgYlZBCgBU8AKNYQFyueDJjEGVk4BcPqBysNcxggA0RCD68nDpSUAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Can't See? Something went wrong!\",\n    \"title\": \"Can't See? Something went wrong!\",\n    \"src\": \"/ml/static/0b32021223e2be0de46b206960080fe7/7d769/model_architecture.png\",\n    \"srcSet\": [\"/ml/static/0b32021223e2be0de46b206960080fe7/5243c/model_architecture.png 240w\", \"/ml/static/0b32021223e2be0de46b206960080fe7/ab158/model_architecture.png 480w\", \"/ml/static/0b32021223e2be0de46b206960080fe7/7d769/model_architecture.png 960w\", \"/ml/static/0b32021223e2be0de46b206960080fe7/5ece7/model_architecture.png 1200w\"],\n    \"sizes\": \"(max-width: 960px) 100vw, 960px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n    \"), \"\\n  \", mdx(\"figcaption\", {\n    parentName: \"figure\"\n  }, mdx(\"b\", {\n    parentName: \"figcaption\"\n  }, mdx(\"center\", {\n    parentName: \"b\"\n  }, \"Binary Audio Classification based on Log-Mel Spectrograms\")))), mdx(\"p\", null, \"While these features (spectrograms) can be generated once after processing all the audios in the dataset, this feature generation needs to be done on the fly to make a model that can be used in deployment i.e given raw audios as input, it should be able to predict the class, that was easily incorporated through a few transforms done within the model using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"torch-audio\"), \".\"), mdx(\"p\", null, \"Even though this architecture is simple, it got us an \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"accuracy of about 87%\"), \". But it is not the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"accuracy\"), \" we need to see, our choice of metric to measure the performance is \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"precision\"), \" as explained earlier. We are still in the process improving these initial baseline numbers of the model. One simple approach for increasing the precision is to increase the threshold, trading-off some coverage in the form of support.\"), mdx(\"h3\", null, \"Misclassification Analysis\"), mdx(\"p\", null, \"We also do a post prediction analysis on the misclassified audios, which revealed an interesting pattern in the dataset and in the kind of audios that the model was finding hard to make predictions on.\"), mdx(\"p\", null, \"Briefly these errors followed 3 major types which now helps to understand the places where we can make improvements.\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Type 1 (Very Short Utterance)\"), \" : say 0.2 seconds in audio of 6 seconds. Due to noise in most part of such short utterance audios, our model predicts it to be noisy and not good in some occasions. This can probably be fixed with VAD which can trim the non speech segments in such short utterance audios.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Type 2 (Long audios)\"), \" : Audio duration is longer than 6.5 seconds with the speaker in latter half. Since we chose to threshold our features (log-mels) at 6.5 seconds, the latter part of the audio is basically truncated and hence such errors.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Type 3 (Ambiguous / Wrongly Labeled)\"), \" : There are samples in the dataset which are not perfectly labelled. One may say these audios are debatablem, some may find them to be bad others may think that they are ok. This type of label noise is something which needs to be tackled.\")), mdx(\"p\", null, \"Needless to say, there are places where we can improve these results, but having a solid baseline model initially is important for incremental improvements over time and after a few iterations we finally see these models in our production systems. \"), mdx(\"p\", null, \"That's all for now. Stay tuned to our \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://vernacular-ai.github.io/ml/rss.xml\"\n  }), \"rss feed\"), \" for updates and more.\"));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"This blog will be a short one, where we'll talk about our approach on filtering out inscrutable audios from  VASR . There are situations in…","timeToRead":3,"banner":null}},"pageContext":{"slug":"/bad-audio-detection","formatString":"DD.MM.YYYY"}}}